version: v1.0
name: workos-rust pipeline

execution_time_limit:
  minutes: 10

agent:
  machine:
    type: e1-standard-2
  containers:
    - name: main
      image: registry.semaphoreci.com/rust:1.60

global_job_config:
  prologue:
    commands:
      - checkout

blocks:
  - name: Test
    task:
      jobs:
        - name: cargo fmt
          commands:
            - cargo fmt --check
        - name: cargo build + cargo test
          commands:
            - pwd
            - ls /usr/local/cargo
            - pushd ~
            - pwd
            - popd
            - cargo build --verbose
            - cargo test --verbose
